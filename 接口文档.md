# SoftWareCup

> v1.0.0

# 账户模块

## PUT 修改用户信息

PUT /user/1

user后面加要修改的用户id，body里面的值想加就加，只要是user表里面的字段名都可以。修改密码也可以用这个东西搞。

> Body 请求参数

```json
{
  "password": "123",
  "status": 0
}
```

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|body|body|object| 否 |none|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## GET 查找用户

GET /user/1

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|token|header|string| 是 |用户token|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 修改头像

POST /file/uploadAvatar/1

输入头像图片文件和id，系统自动保存

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 手机号验证码登录

POST /login2

需要先发送验证码

> Body 请求参数

```json
{
  "phone": "15859387028",
  "verity": "495665"
}
```

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|body|body|object| 否 |none|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 登录

POST /login

可以用手机号登录，可以用用户名登录，但要保证手机号和用户名的唯一性

> Body 请求参数

```json
{
  "name": "hjh",
  "password": "123456"
}
```

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|body|body|object| 否 |none|

> 返回示例

> 成功

```json
{
  "status": true,
  "code": 0,
  "message": null,
  "data": {
    "name": "hjh",
    "id": 1,
    "avatar": null,
    "status": null,
    "token": "eyJ0eXBlIjoiSldUIiwiYWxnIjoiSFM1MTIifQ.eyJzdWIiOiIxIiwiaWF0IjoxNjU0ODM3ODQ4LCJleHAiOjE2NTU0NDI2NDh9.YKQlNPeH5WO0OcC7MzQPHAHnh2sBR6VrV4RYcyorEvUiI2tuw79HEqnPX2WgvbAyLf5wG0DjQgsC4NlfTnOH9g"
  },
  "otherData": {}
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## GET 发送验证码（注册）

GET /code/sendRegister

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|memPhone|query|string| 否 |none|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## GET 发送验证码

GET /code/sendCode

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|memPhone|query|string| 否 |none|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## GET 检验用户名是否唯一

GET /isExist

成功true失败false

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|name|query|string| 是 |none|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|boolean|

## POST 注册

POST /register

> Body 请求参数

```json
{
  "name": "test",
  "phone": "18297799166",
  "password": "123s"
}
```

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|code|query|string| 否 |验证码|
|body|body|object| 否 |none|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

# AI

## POST 变化检测

POST /ai/changeDetection

如果有userId参数，则会保存预测记录（下同）
输入：一张遥感图片url
输出：透明背景二值图片url

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|file1|query|string| 是 |图片1 url|
|file2|query|string| 是 |图片2 url|
|userId|query|integer| 否 |用户id|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 目标提取

POST /ai/objectExtraction

输入：一张遥感图片url
输出：透明背景二值图片url

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|file|query|string| 是 |图片url|
|userId|query|integer| 否 |用户id|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 地物分类

POST /ai/terrainClassification

输入：一张遥感图片url
输出：透明背景彩色图片url

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|file|query|string| 是 |图片url|
|userId|query|integer| 否 |用户id|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 目标检测

POST /ai/objectDetection

输入：一张遥感图片url
输出：标注好的图片与目标检测结果列表

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|file|query|string| 是 |图片url|
|userId|query|integer| 否 |用户id|

> 返回示例

> 成功

```json
{
  "category_id": 0,
  "category": "playground",
  "bbox": [
    306.23284912109375,
    273.0307312011719,
    177.12255859375,
    410.4651184082031
  ],
  "score": 0.7360728979110718
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

# 图片

## POST 图片叠加

POST /file/overlay

二值图片与原图叠加

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|file|query|string| 否 |原图url|
|result|query|string| 是 |结果图片url|
|rgba|query|string| 是 |结果图片color|
|transparent|query|integer| 否 |1透明底图  其它值或不填不透明|
|opacity|query|number| 否 |地物分类专属，颜色透明度|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 删除图片库中的某一图片

POST /library/removeOne

返回1表示删除成功
返回0表示数据库中无此图片

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|id|query|integer| 是 |图片id|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|integer|

## POST 上传图片

POST /file/uploadImg

上传图片，返回图片url，若有userId参数，则会把图片保存到用户图片库，若无则不会保存,message为图片id

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|userId|query|integer| 否 |用户id|

> 返回示例

> 成功

```json
{
  "status": true,
  "code": 200,
  "message": "10",
  "data": "https://cdn.bewcf.info/softwareCup/aead0181-2c3f-4d61-bd23-c6678eed5832.jpg",
  "otherData": {}
}
```

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## GET 获取图片库的所有图片

GET /library/getAll

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|userId|query|integer| 是 |用户id|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 上传多张图片

POST /fild/uploadImgs

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

# 预测记录

## GET 获取所有预测记录

GET /record/getAll

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|userId|query|integer| 是 |用户id|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## GET 统计用户预测记录

GET /record/statistics

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|userId|query|integer| 是 |用户id|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

## POST 删除某一预测记录

POST /record/removeOne

返回1表示删除成功
返回0表示数据库中无此记录

### 请求参数

|名称|位置|类型|必选|说明|
|---|---|---|---|---|
|id|query|integer| 是 |记录id|

> 返回示例

### 返回结果

|状态码|状态码含义|说明|数据模型|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|成功|Inline|

### 返回数据结构

# 数据模型

